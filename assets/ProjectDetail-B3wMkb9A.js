import{d as h,c as b,o as g,a as u,b as O,n as H,t as V,_ as w,r as k,e as M,w as S,F as U,f as m,G as x,g as P,A as y,u as E,h as J,i as T,B as K,j as Y,k as I,l as N,m as Q,p as W,q as X,s as Z,v as ee,x as j,y as te,z as A,C as ae,M as B,D as se}from"./index-DX3kJUiQ.js";const le={class:"date_picker"},oe=["value"],ne={key:0,class:"error_message"},ue=h({__name:"GeneralDatePicker",props:{modelValue:{},error:{}},emits:["update:modelValue"],setup(d,{emit:v}){return(s,t)=>(g(),b("div",le,[t[1]||(t[1]=u("label",{class:"label",for:"deadline"},"Deadline:",-1)),u("input",{id:"deadline",type:"date",value:d.modelValue,onInput:t[0]||(t[0]=l=>s.$emit("update:modelValue",l.target.value)),class:H(["deadline_input",{error:d.error}])},null,42,oe),d.error?(g(),b("span",ne,V(d.error),1)):O("",!0)]))}}),re=w(ue,[["__scopeId","data-v-c482e9ee"]]),de={class:"title_form"},ie={class:"form"},ce=h({__name:"TaskForm",props:{task:{}},emits:["submit"],setup(d,{emit:v}){const s=k(""),t=k(""),l=k(""),o=k(""),a=[{value:"",label:"All statuses"},{value:"To do",label:"To do"},{value:"In progress",label:"In progress"},{value:"Done",label:"Done"}],e=M({}),n=d,D=v,$=()=>{e.title="",e.assignee="",e.status="",e.deadline="";let r=!1;if(s.value.trim()||(e.title="Name is required",r=!0),t.value.trim()||(e.assignee="Assignee is required",r=!0),l.value||(e.status="Status is required",r=!0),!o.value)e.deadline="Deadline is required",r=!0;else{const f=new Date(o.value),p=new Date;p.setHours(0,0,0,0),f<p&&(e.deadline="Select a future date",r=!0)}r||D("submit",{id:n.task?.id,title:s.value,assignee:t.value,status:l.value,deadline:o.value})};return S(()=>n.task,r=>{r?(s.value=r.title,t.value=r.assignee,l.value=r.status,o.value=r.deadline):(s.value="",t.value="",l.value="",o.value="")},{immediate:!0}),(r,f)=>(g(),b(U,null,[u("h3",de,V(d.task?"Edit task":"Create task"),1),u("div",ie,[m(x,{modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=p=>s.value=p),placeholder:"Title",error:e.title},null,8,["modelValue","error"]),m(x,{modelValue:t.value,"onUpdate:modelValue":f[1]||(f[1]=p=>t.value=p),placeholder:"Assignee",label:"Assignee",error:e.assignee},null,8,["modelValue","error"]),m(P,{modelValue:l.value,"onUpdate:modelValue":f[2]||(f[2]=p=>l.value=p),options:a,error:e.status},null,8,["modelValue","error"]),m(re,{modelValue:o.value,"onUpdate:modelValue":f[3]||(f[3]=p=>o.value=p),error:e.deadline},null,8,["modelValue","error"])]),m(y,{class:"save_button",text:"Save",variant:"primary",onClick:$})],64))}}),me={class:"ag-theme-quartz"},ve=h({__name:"TaskTable",props:{tasks:{}},emits:["edit","delete"],setup(d,{emit:v}){const s=v,{formatYMD:t}=E(),l={sortable:!0,resizable:!0,flex:1},o=[{headerName:"ID",field:"id",flex:1,rowDrag:!0,comparator:(n,D)=>Number(n)-Number(D)},{headerName:"Title",field:"title",flex:1},{headerName:"Assignee",field:"assignee",flex:1},{headerName:"Status",field:"status",flex:1},{headerName:"Deadline",flex:1,field:"deadline",valueFormatter:n=>t(n.value)},{headerName:"Actions",field:"actions",flex:1,cellRenderer:J,cellRendererParams:n=>({rowData:n.data,onEdit:a,onDelete:e}),resizable:!1}];function a(n){s("edit",n)}function e(n){s("delete",n)}return(n,D)=>(g(),b("div",me,[m(T(K),{class:"grid_table",columnDefs:o,rowData:d.tasks,defaultColDef:l,domLayout:"autoHeight",rowDragManaged:!0,animateRows:!0},null,8,["rowData"])]))}}),pe={class:"kanban"},fe={class:"kanban_column_title"},ke={class:"kanban_card"},_e={class:"kanban_card_title"},ge=h({__name:"KanbanBoard",props:{tasks:{}},setup(d){const v=d,{formatYMD:s}=E(),t=M([{status:"To do",label:"To do",tasks:[]},{status:"In progress",label:"In progress",tasks:[]},{status:"Done",label:"Done",tasks:[]}]);S(()=>v.tasks,o=>{t.forEach(a=>a.tasks=[]),o.forEach(a=>{const e=t.find(n=>n.status===a.status);e&&e.tasks.push({...a})})},{immediate:!0,deep:!0});function l(o){const a=o.item.__draggable_context.element,e=o.to.dataset.status;a.status=e}return(o,a)=>(g(),b("div",pe,[(g(!0),b(U,null,Y(t,e=>(g(),b("div",{key:e.status,class:"kanban-column"},[u("h3",fe,V(e.label),1),m(T(Q),{modelValue:e.tasks,"onUpdate:modelValue":n=>e.tasks=n,group:"kanban","item-key":"id","data-status":e.status,onAdd:l},{item:I(({element:n})=>[u("div",ke,[u("h4",_e,"Title: "+V(n.title),1),u("p",null,[a[0]||(a[0]=u("span",null,"Status:",-1)),N(V(n.status),1)]),u("p",null,[a[1]||(a[1]=u("span",null,"Deadline:",-1)),N(V(T(s)(n.deadline)),1)])])]),_:1},8,["modelValue","onUpdate:modelValue","data-status"])]))),128))]))}}),be=w(ge,[["__scopeId","data-v-aa84a46c"]]),Ve={class:"toggle_switch"},De={class:"switch"},Te=["checked"],he=h({__name:"ToggleSwitch",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(d,{emit:v}){const s=d,t=v,l=k(s.modelValue);S(()=>s.modelValue,a=>{l.value=a});const o=a=>{const e=a.target;l.value=e.checked,t("update:modelValue",e.checked)};return(a,e)=>(g(),b("div",Ve,[e[1]||(e[1]=u("span",null,"table view ",-1)),u("label",De,[u("input",{type:"checkbox",checked:l.value,onChange:o},null,40,Te),e[0]||(e[0]=u("span",{class:"slider"},null,-1))]),e[2]||(e[2]=u("span",null,"kanban view",-1))]))}}),we=w(he,[["__scopeId","data-v-e8ce8a3d"]]);function Se(d,v){const s=localStorage.getItem(d),t=k(s?JSON.parse(s):v);return S(t,l=>{localStorage.setItem(d,JSON.stringify(l))},{deep:!0}),t}const $e={class:"title_wrapper"},xe={class:"title"},ye={class:"wrapper_actions"},Ie={class:"filters"},Ce={class:"actions"},Ne=h({__name:"ProjectDetail",setup(d){const v=k(""),s=k(""),t=k(null),l=k(!1),o=k(!1),a=Se("tasksViewMode",!0),e=k(null),n=[{value:"",label:"All statuses"},{value:"To do",label:"To do"},{value:"In progress",label:"In progress"},{value:"Done",label:"Done"}],D=W(),$=X(),r=Z(),f=ee(),p=D.params.id,q=j(()=>f.projects.find(i=>i.id===p)||{name:"..."}),C=j(()=>r.tasks.filter(i=>i.projectId===p).filter(i=>i.assignee.toLowerCase().includes(v.value.toLowerCase())).filter(i=>s.value?i.status===s.value:!0)),F=()=>{e.value=null,l.value=!0},R=i=>{e.value=i,l.value=!0},z=async i=>{t.value=i,o.value=!0},G=async()=>{t.value&&await r.deleteTask(t.value.id),o.value=!1},L=async i=>{if(i.id)await r.updateTask(i.id,i);else{const c={...i,projectId:p};await r.addTask(c)}l.value=!1};return te(()=>{f.fetchProjects(),r.fetchTasks()}),(i,c)=>(g(),b("div",null,[u("div",$e,[u("h2",xe,"Project "+V(q.value.name),1),m(we,{modelValue:T(a),"onUpdate:modelValue":c[0]||(c[0]=_=>ae(a)?a.value=_:null)},null,8,["modelValue"])]),u("div",ye,[u("div",Ie,[m(x,{modelValue:v.value,"onUpdate:modelValue":c[1]||(c[1]=_=>v.value=_),placeholder:"Filter by title"},null,8,["modelValue"]),m(P,{modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=_=>s.value=_),options:n},null,8,["modelValue"])]),u("div",Ce,[m(y,{text:"Back to projects",variant:"back",onClick:c[3]||(c[3]=_=>T($).back())}),m(y,{text:"Add task",variant:"primary",onClick:F})])]),m(B,{modelValue:l.value,"onUpdate:modelValue":c[4]||(c[4]=_=>l.value=_)},{default:I(()=>[m(ce,{onSubmit:L,task:e.value},null,8,["task"])]),_:1},8,["modelValue"]),m(B,{modelValue:o.value,"onUpdate:modelValue":c[6]||(c[6]=_=>o.value=_)},{default:I(()=>[m(se,{onSubmit:G,task:t.value,onCancel:c[5]||(c[5]=_=>o.value=!1)},null,8,["task"])]),_:1},8,["modelValue"]),T(a)?(g(),A(ve,{key:0,tasks:C.value,onEdit:R,onDelete:z},null,8,["tasks"])):(g(),A(be,{key:1,tasks:C.value},null,8,["tasks"]))]))}}),Ae=w(Ne,[["__scopeId","data-v-4870d177"]]);export{Ae as default};
